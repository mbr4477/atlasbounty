(this.webpackJsonpatlasbounty=this.webpackJsonpatlasbounty||[]).push([[8],{228:function(e,t,n){e.exports=n(452)},234:function(e,t,n){var a={"./ion-action-sheet-controller_8.entry.js":[458,43],"./ion-action-sheet-ios.entry.js":[459,44],"./ion-action-sheet-md.entry.js":[460,45],"./ion-alert-ios.entry.js":[461,24],"./ion-alert-md.entry.js":[462,25],"./ion-app_8-ios.entry.js":[463,11],"./ion-app_8-md.entry.js":[464,12],"./ion-avatar_3-ios.entry.js":[465,46],"./ion-avatar_3-md.entry.js":[466,47],"./ion-back-button-ios.entry.js":[467,48],"./ion-back-button-md.entry.js":[468,49],"./ion-backdrop-ios.entry.js":[469,81],"./ion-backdrop-md.entry.js":[470,82],"./ion-button_2-ios.entry.js":[471,50],"./ion-button_2-md.entry.js":[472,51],"./ion-card_5-ios.entry.js":[473,52],"./ion-card_5-md.entry.js":[474,53],"./ion-checkbox-ios.entry.js":[475,54],"./ion-checkbox-md.entry.js":[476,55],"./ion-chip-ios.entry.js":[477,56],"./ion-chip-md.entry.js":[478,57],"./ion-col_3.entry.js":[479,83],"./ion-datetime_3-ios.entry.js":[480,20],"./ion-datetime_3-md.entry.js":[481,21],"./ion-fab_3-ios.entry.js":[482,58],"./ion-fab_3-md.entry.js":[483,59],"./ion-img.entry.js":[484,84],"./ion-infinite-scroll_2-ios.entry.js":[485,39],"./ion-infinite-scroll_2-md.entry.js":[486,40],"./ion-input-ios.entry.js":[487,60],"./ion-input-md.entry.js":[488,61],"./ion-item-option_3-ios.entry.js":[489,62],"./ion-item-option_3-md.entry.js":[490,63],"./ion-item_8-ios.entry.js":[491,64],"./ion-item_8-md.entry.js":[492,65],"./ion-loading-ios.entry.js":[493,26],"./ion-loading-md.entry.js":[494,27],"./ion-menu_4-ios.entry.js":[495,18],"./ion-menu_4-md.entry.js":[496,19],"./ion-modal-ios.entry.js":[497,14],"./ion-modal-md.entry.js":[498,15],"./ion-nav_5.entry.js":[499,13],"./ion-popover-ios.entry.js":[500,16],"./ion-popover-md.entry.js":[501,17],"./ion-progress-bar-ios.entry.js":[502,66],"./ion-progress-bar-md.entry.js":[503,67],"./ion-radio_2-ios.entry.js":[504,32],"./ion-radio_2-md.entry.js":[505,33],"./ion-range-ios.entry.js":[506,68],"./ion-range-md.entry.js":[507,69],"./ion-refresher_2-ios.entry.js":[508,41],"./ion-refresher_2-md.entry.js":[509,42],"./ion-reorder_2-ios.entry.js":[510,37],"./ion-reorder_2-md.entry.js":[511,38],"./ion-ripple-effect.entry.js":[512,85],"./ion-route_4.entry.js":[513,70],"./ion-searchbar-ios.entry.js":[514,28],"./ion-searchbar-md.entry.js":[515,29],"./ion-segment_2-ios.entry.js":[516,71],"./ion-segment_2-md.entry.js":[517,72],"./ion-select_3-ios.entry.js":[518,34],"./ion-select_3-md.entry.js":[519,35],"./ion-slide_2-ios.entry.js":[520,86],"./ion-slide_2-md.entry.js":[521,87],"./ion-spinner.entry.js":[522,73],"./ion-split-pane-ios.entry.js":[523,88],"./ion-split-pane-md.entry.js":[524,89],"./ion-tab-bar_2-ios.entry.js":[525,74],"./ion-tab-bar_2-md.entry.js":[526,75],"./ion-tab_2.entry.js":[527,36],"./ion-text.entry.js":[528,76],"./ion-textarea-ios.entry.js":[529,77],"./ion-textarea-md.entry.js":[530,78],"./ion-toast-ios.entry.js":[531,30],"./ion-toast-md.entry.js":[532,31],"./ion-toggle-ios.entry.js":[533,22],"./ion-toggle-md.entry.js":[534,23],"./ion-virtual-scroll.entry.js":[535,90]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=234,e.exports=r},235:function(e,t,n){var a={"./ion-icon.entry.js":[539,98]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=235,e.exports=r},255:function(e,t){},257:function(e,t){},287:function(e,t){},288:function(e,t){},332:function(e,t){},334:function(e,t){},357:function(e,t){},451:function(e,t,n){},452:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(76),i=n.n(o),s=n(38),l=n(18),c=n(1),u=n(218),m=(n(240),n(6)),d=n(7),f=n(11),h=n(10),y=n(12),p=n(221),g=n.n(p),j=function(e,t,n,a){var r={aggregateBy:[{dataSourceId:"derived:com.google.step_count.delta:com.google.android.gms:estimated_steps"}],bucketByTime:{durationMillis:864e5},startTimeMillis:t.getTime(),endTimeMillis:n.getTime()};g.a.post("https://www.googleapis.com/fitness/v1/users/me/dataset:aggregate",{json:r,headers:{Authorization:"Bearer "+e}},(function(e,t,n){if(e||n.error)console.log(n);else{var r=n.bucket.flatMap((function(e){return e.dataset.flatMap((function(e){return e.point.flatMap((function(e){return e.value.flatMap((function(e){return e.intVal}))}))}))})).reduce((function(e,t){return e+t}),0);a(r)}}))},E=function(e,t){var n=Math.floor(1e-4*e.steps*100)/100,a=Math.min(n,t.cost),r=0;return n>t.cost&&(r=Math.floor(100*(n-t.cost))),{amount:a,points:r}},b=n(26),v=(n(201),n(118),function(){try{b.initializeApp({apiKey:"AIzaSyBJT5z1sGK3A2NH5r1aZPM3EF_pGAQar1I",authDomain:"atlas-bounty-1574529450782.firebaseapp.com",databaseURL:"https://atlas-bounty-1574529450782.firebaseio.com",projectId:"atlas-bounty-1574529450782",storageBucket:"atlas-bounty-1574529450782.appspot.com",messagingSenderId:"496812476716",appId:"1:496812476716:web:5005c999dbc35b1ca04489"})}catch(e){}return b.app()}),O=function(e,t){var n=v().firestore();null!==e&&n.collection("users").doc(e).get().then((function(e){if(e.exists){var a=e.data().tier;n.collection("tiers").doc(a).get().then((function(e){e.exists?t(e.data()):t(null)}))}else t(null)})).catch((function(e){console.log(e),t(null)}))},k=function(e,t){var n=new Date;return"month"===e&&(n.setDate(t.billingDayOfMonth),t.billingDayOfMonth>(new Date).getDate()&&n.setMonth(n.getMonth()-1),n.setHours(0,0,0,0)),n},S=n(542),w=n(543),_=function(e,t){var n=v().firestore();null!==e&&n.collection("users").doc(e).get().then((function(e){e.exists?t(e.data()):t(null)})).catch((function(e){console.log(e),t(null)}))},x=n(541),T=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={profileImage:e.profileImage,showClose:e.showClose},n}return Object(y.a)(t,e),Object(d.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState((function(t){return{profileImage:e.profileImage}}))}},{key:"render",value:function(){return r.a.createElement(c.m,null,r.a.createElement(c.x,{color:"dark"},r.a.createElement(c.w,null,"ATLAS BOUNTY"),r.a.createElement(c.f,{slot:"start"},r.a.createElement(c.d,null),r.a.createElement(c.c,{style:{width:"2.5em",height:"2.5em",marginLeft:"10px"},slot:"icon-only"},r.a.createElement("img",{src:this.state.profileImage}))),r.a.createElement(c.f,{slot:"primary"},this.state.showClose?null:r.a.createElement(s.c,{to:"/settings",style:{marginRight:"10px"}},r.a.createElement(c.n,{icon:x.a,color:"light",size:"large"})))))}}]),t}(r.a.Component),I={display:"flex",justifyContent:"center",alignItems:"center","flex-direction":"column",height:"100%"},N=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={redirectToLogin:!1,redirectToSignUp:!1,profileImage:"",givenName:"",tier:null,value:0,points:0,data:{steps:0}},v(),null!=b.auth().currentUser&&n.userLoaded(b.auth().currentUser),b.auth().onAuthStateChanged((function(e){n.userLoaded(e)})),n}return Object(y.a)(t,e),Object(d.a)(t,[{key:"userLoaded",value:function(e){var t=this;if(e){var n=localStorage.getItem("access-token");O(e.uid,(function(a){console.log(a),null===a?t.setState((function(e){return{redirectToSignUp:!0}})):_(e.uid,(function(e){var r=k(a.period,e);j(n,r,new Date,(function(e){var n=E({steps:e},a);t.setState((function(t){return{value:n.amount,points:n.points,data:{steps:e},tier:a}}))}))}))})),this.setState((function(t){return{profileImage:e.photoURL,displayName:e.displayName}}))}else this.setState((function(e){return{redirectToLogin:!0}}))}},{key:"render",value:function(){return r.a.createElement(c.u,null,r.a.createElement(T,{profileImage:this.state.profileImage,showClose:!1}),r.a.createElement(c.l,null,this.state.redirectToLogin?r.a.createElement(l.a,{to:"/login"}):r.a.createElement("div",null),this.state.redirectToSignUp?r.a.createElement(l.a,{to:"/signup"}):r.a.createElement("div",null),r.a.createElement("div",{style:I},r.a.createElement(c.g,{className:"font",style:{width:"350px"}},r.a.createElement(c.i,null,r.a.createElement(c.j,null,"EARNINGS"),r.a.createElement(c.k,null,r.a.createElement("span",{style:{fontSize:"1em"}},"$"),r.a.createElement("span",{style:{fontSize:"4em"}},this.state.value),r.a.createElement("span",{style:{fontSize:"1em"}},"/",this.state.tier?this.state.tier.cost:""),r.a.createElement(c.n,{icon:S.a,color:"dark"})))),r.a.createElement(c.g,{className:"font",style:{width:"350px"}},r.a.createElement(c.i,null,r.a.createElement(c.j,null,"STEPS"),r.a.createElement(c.k,null,r.a.createElement("span",{className:"label",style:{fontSize:"3em"}},this.state.data.steps.toLocaleString())))),r.a.createElement(c.g,{className:"font",style:{width:"350px"}},r.a.createElement(c.i,null,r.a.createElement(c.j,null,"POINTS THIS ",this.state.tier?this.state.tier.period.toUpperCase():""),r.a.createElement(c.k,null,r.a.createElement(c.n,{icon:w.a,color:"dark",size:"large"}),r.a.createElement("span",{className:"label",style:{fontSize:"3em"}},this.state.points)))),r.a.createElement("div",{style:{flexGrow:1}}))))}}]),t}(r.a.Component),D=(n(451),{display:"flex",justifyContent:"center",alignItems:"center","flex-direction":"column",height:"100%"}),A=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={redirectToHome:!1},v(),n}return Object(y.a)(t,e),Object(d.a)(t,[{key:"signin",value:function(){var e=this,t=new b.auth.GoogleAuthProvider;t.addScope("https://www.googleapis.com/auth/fitness.activity.read"),b.auth().signInWithPopup(t).then((function(t){t.credential.accessToken;localStorage.setItem("access-token",t.credential.accessToken),e.setState((function(e){return{redirectToHome:!0}}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement(c.u,null,r.a.createElement(c.l,null,r.a.createElement("div",{style:D},r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement("h1",null,"ATLAS BOUNTY"),r.a.createElement("h2",null,"The world is your bounty."),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(c.e,{onClick:function(){return e.signin()}},"Log In With Google"),this.state.redirectToHome?r.a.createElement(l.a,{to:"/home"}):r.a.createElement("div",null),r.a.createElement("div",{style:{flexGrow:1}}))))}}]),t}(r.a.Component),C=n(60);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var U=function(e){v().firestore().collection("tiers").get().then((function(t){var n=t.docs.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(C.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id},e.data())}));e(n)}))},M=function(e,t){var n=v(),a=n.firestore();if(n.auth().currentUser){var r=new Date;r.setMonth(r.getMonth()+1);var o=r.getDate(),i=n.auth().currentUser;a.collection("users").doc(i.uid).set({tier:e,billingDayOfMonth:o,nextBillingDate:r,cancelAfterNextBilling:!1},{merge:!0}).then((function(){t()}))}},B={display:"flex",justifyContent:"center",alignItems:"center","flex-direction":"column",height:"100%"},P=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={redirectToHome:!1,redirectToLogin:!1,tiers:[]},U((function(e){n.setState((function(t){return{tiers:e}}))})),n}return Object(y.a)(t,e),Object(d.a)(t,[{key:"didClickTier",value:function(e){var t=this;M(e.id,(function(){t.setState((function(e){return{redirectToHome:!0}}))}))}},{key:"logout",value:function(){b.auth().signOut(),localStorage.removeItem("access-token"),this.setState((function(e){return{redirectToLogin:!0}}))}},{key:"render",value:function(){var e=this;return r.a.createElement(c.u,null,r.a.createElement(c.l,null,this.state.redirectToLogin?r.a.createElement(l.a,{to:"/login"}):r.a.createElement("div",null),r.a.createElement("div",{style:B},r.a.createElement("h1",null,"ATLAS BOUNTY"),r.a.createElement("h2",null,"Subscribe"),this.state.redirectToHome?r.a.createElement(l.a,{to:"/home"}):r.a.createElement("div",null),this.state.tiers.map((function(t){return r.a.createElement(c.g,{className:"hover-card",onClick:function(){e.didClickTier(t)}},r.a.createElement(c.i,{style:{width:350}},r.a.createElement(c.j,null,t.name.toUpperCase()),r.a.createElement(c.k,null,"$",r.a.createElement("span",{style:{fontSize:"3em"}},t.cost),"/",t.period)),r.a.createElement(c.h,null,t.description))})),r.a.createElement(c.e,{onClick:function(){return e.logout()},fill:"clear"},"Sign Out"))))}}]),t}(r.a.Component),G=function(e){var t=v(),n=t.firestore();if(t.auth().currentUser){var a=t.auth().currentUser;n.collection("users").doc(a.uid).set({cancelAfterNextBilling:!0},{merge:!0}).then((function(){e()}))}},H=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={profileImage:"",userData:null,tierName:"",redirectToHome:!1,userId:""},v(),null!=b.auth().currentUser&&n.userLoaded(b.auth().currentUser),b.auth().onAuthStateChanged((function(e){n.userLoaded(e)})),n}return Object(y.a)(t,e),Object(d.a)(t,[{key:"userLoaded",value:function(e){var t=this;if(e){localStorage.getItem("access-token");_(e.uid,(function(n){t.setState((function(t){return{userId:e.uid,userData:n}})),O(e.uid,(function(e){t.setState((function(t){return{tierName:e.name}}))}))})),this.setState((function(t){return{profileImage:e.photoURL}}))}}},{key:"logout",value:function(){b.auth().signOut(),localStorage.removeItem("access-token"),this.setState((function(e){return{redirectToHome:!0}}))}},{key:"unsubscribe",value:function(){var e=this;G((function(){_(e.state.userId,(function(t){e.setState((function(e){return{userData:t}}))}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement(c.u,null,this.state.redirectToHome?r.a.createElement(l.a,{to:"/home"}):r.a.createElement("div",null),r.a.createElement(T,{profileImage:this.state.profileImage,showClose:!0}),r.a.createElement(c.l,null,r.a.createElement(c.r,null,r.a.createElement(c.s,null,"BILLING INFORMATION"),r.a.createElement(c.o,null,r.a.createElement(c.p,null,"Day of Month"),r.a.createElement(c.t,{slot:"end"},this.state.userData?this.state.userData.billingDayOfMonth:"")),r.a.createElement(c.o,null,r.a.createElement(c.p,null,"Next Billing Date"),r.a.createElement(c.t,{slot:"end"},this.state.userData?new Date(1e3*this.state.userData.nextBillingDate.seconds).toLocaleDateString():"")),r.a.createElement(c.s,null,"ACCOUNT MANAGEMENT"),r.a.createElement(c.o,null,r.a.createElement(c.p,null,"Subscription Plan"),this.state.userData&&this.state.userData.cancelAfterNextBilling?r.a.createElement(c.t,{slot:"end"},"Expires After Next Bill"):null,r.a.createElement(c.t,{slot:"end"},this.state.tierName)),r.a.createElement(s.c,{to:"/signup",style:{textDecoration:"none"}},r.a.createElement(c.o,{button:!0},r.a.createElement(c.p,{style:{textAlign:"center"},color:"primary"},"CHANGE PLAN"))),r.a.createElement(c.o,{button:!0,onClick:function(){return e.unsubscribe()},disabled:!this.state.userData||this.state.userData.cancelAfterNextBilling},r.a.createElement(c.p,{style:{textAlign:"center"},color:"primary"},"UNSUBCRIBE")),r.a.createElement(c.o,{button:!0,onClick:function(){return e.logout()}},r.a.createElement(c.p,{style:{textAlign:"center"},color:"primary"},"SIGN OUT")))))}}]),t}(r.a.Component),z=function(){return r.a.createElement(c.b,null,document.title="Atlas Bounty",r.a.createElement(s.a,{basename:"/atlasbounty"},r.a.createElement(u.a,{basename:"/atlasbounty"},r.a.createElement(c.v,null,r.a.createElement(l.b,{path:"/home",component:N,exact:!0}),r.a.createElement(l.b,{exact:!0,path:"/",render:function(){return r.a.createElement(l.a,{to:"/home"})}}),r.a.createElement(l.b,{path:"/login",component:A,exact:!0}),r.a.createElement(l.b,{path:"/signup",component:P,exact:!0}),r.a.createElement(l.b,{path:"/settings",component:H,exact:!0})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[228,9,10]]]);
//# sourceMappingURL=main.9a42cfc7.chunk.js.map